{"ast":null,"code":"import _taggedTemplateLiteral from\"/home/arkajit/Desktop/shareYourExp/client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";import _defineProperty from\"/home/arkajit/Desktop/shareYourExp/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/home/arkajit/Desktop/shareYourExp/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/home/arkajit/Desktop/shareYourExp/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/arkajit/Desktop/shareYourExp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/arkajit/Desktop/shareYourExp/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _templateObject,_templateObject2,_templateObject3;import{useState}from\"react\";import{useEffect}from\"react\";import{useContext}from\"react\";import{useLocation,useNavigate}from\"react-router-dom\";import{Box,Button,FormControl,InputBase,styled,TextareaAutosize}from\"@mui/material\";import{AddCircle as Add}from'@mui/icons-material';import{DataContext}from\"../../context/DataProvider\";import{API}from\"../../service/api\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var initialPost={title:'',description:'',picture:'',username:'',categories:'',createdate:new Date()};var CreatePost=function CreatePost(){var _useState=useState(initialPost),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),file=_useState4[0],setFile=_useState4[1];var url=post.picture?post.picture:'https://images.unsplash.com/photo-1543128639-4cb7e6eeef1b?ixid=MnwxMjA3fDB8MHxzZWFyY2h8Mnx8bGFwdG9wJTIwc2V0dXB8ZW58MHx8MHx8&ixlib=rb-1.2.1&w=1000&q=80';var location=useLocation();var navigate=useNavigate();var _useContext=useContext(DataContext),account=_useContext.account;useEffect(function(){var _location$search;var getImg=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var data,res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!file){_context.next=8;break;}data=new FormData();data.append(\"name\",file.name);data.append(\"file\",file);//API call\n_context.next=6;return API.uploadFile(data);case 6:res=_context.sent;if(res.isSuccess){post.picture=res.data;}case 8:case\"end\":return _context.stop();}},_callee);}));return function getImg(){return _ref.apply(this,arguments);};}();getImg();post.categories=((_location$search=location.search)===null||_location$search===void 0?void 0:_location$search.split(\"=\")[1])||\"all\";post.username=account.username;},[file]);var handleChange=function handleChange(e){setPost(_objectSpread(_objectSpread({},post),{},_defineProperty({},e.target.name,e.target.value)));};var savePost=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var res;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(post.picture===''){post.picture=url;}_context2.next=3;return API.createPost(post);case 3:res=_context2.sent;if(res.isSuccess){navigate('/');}case 5:case\"end\":return _context2.stop();}},_callee2);}));return function savePost(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(Image,{src:url,alt:\"post\"}),/*#__PURE__*/_jsxs(StyledFormControl,{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",children:/*#__PURE__*/_jsx(Add,{fontSize:\"large\",color:\"action\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileInput\",style:{display:\"none\"},onChange:function onChange(e){return setFile(e.target.files[0]);}}),/*#__PURE__*/_jsx(InputTextField,{onChange:function onChange(e){return handleChange(e);},name:\"title\",placeholder:\"Title\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return savePost();},variant:\"contained\",color:\"primary\",children:\"Publish\"})]}),/*#__PURE__*/_jsx(Textarea,{rowsMin:5,placeholder:\"Tell your story...\",name:\"description\",onChange:function onChange(e){return handleChange(e);}})]});};var Container=styled(Box)(function(_ref3){var theme=_ref3.theme;return _defineProperty({margin:'50px 100px'},theme.breakpoints.down('md'),{margin:0});});var Image=styled('img')({width:'100%',height:'50vh',objectFit:'cover'});var StyledFormControl=styled(FormControl)(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    margin-top: 10px;\\n    display: flex;\\n    flex-direction: row;\\n\"])));var InputTextField=styled(InputBase)(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n    flex: 1;\\n    margin: 0 30px;\\n    font-size: 25px;\\n\"])));var Textarea=styled(TextareaAutosize)(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n    width: 100%;\\n    border: none;\\n    margin-top: 50px;\\n    font-size: 18px;\\n    &:focus-visible {\\n        outline: none;\\n    }\\n\"])));export default CreatePost;","map":{"version":3,"names":["useState","useEffect","useContext","useLocation","useNavigate","Box","Button","FormControl","InputBase","styled","TextareaAutosize","AddCircle","Add","DataContext","API","initialPost","title","description","picture","username","categories","createdate","Date","CreatePost","post","setPost","file","setFile","url","location","navigate","account","getImg","data","FormData","append","name","uploadFile","res","isSuccess","search","split","handleChange","e","target","value","savePost","createPost","display","files","Container","theme","margin","breakpoints","down","Image","width","height","objectFit","StyledFormControl","InputTextField","Textarea"],"sources":["/home/arkajit/Desktop/shareYourExp/client/src/components/create/CreatePost.jsx"],"sourcesContent":["import { useState } from \"react\";\nimport { useEffect } from \"react\";\nimport { useContext } from \"react\";\n\nimport { useLocation, useNavigate } from \"react-router-dom\";\n\nimport { Box, Button, FormControl, InputBase, styled, TextareaAutosize } from \"@mui/material\";\nimport { AddCircle as Add } from '@mui/icons-material';\n\nimport { DataContext } from \"../../context/DataProvider\";\nimport { API } from \"../../service/api\";\n\n\nconst initialPost = {\n    title : '',\n    description : '',\n    picture : '',\n    username : '',\n    categories : '',\n    createdate : new Date()\n}\n\n\nconst CreatePost = ()=> {\n\n    \n    const [post, setPost] = useState(initialPost);\n    const [file,setFile] = useState('');\n    \n    const url = post.picture ? post.picture  : 'https://images.unsplash.com/photo-1543128639-4cb7e6eeef1b?ixid=MnwxMjA3fDB8MHxzZWFyY2h8Mnx8bGFwdG9wJTIwc2V0dXB8ZW58MHx8MHx8&ixlib=rb-1.2.1&w=1000&q=80';\n    \n    const location = useLocation();\n    const navigate = useNavigate();\n    const {account} = useContext(DataContext);\n\n    \n    \n    useEffect(()=>{\n        const getImg = async()=>{\n            if(file){\n                const data = new FormData();\n                data.append(\"name\",file.name);\n                data.append(\"file\",file);\n                \n                //API call\n                const res = await API.uploadFile(data);\n                if(res.isSuccess){\n                    post.picture = res.data;\n                }\n            }\n        }\n        getImg();\n        post.categories = location.search?.split(\"=\")[1] || \"all\";\n        post.username = account.username;\n    },[file])\n    \n    const handleChange = (e)=>{\n        setPost({...post,[e.target.name]:e.target.value});\n    }\n  \n    const savePost = async()=>{\n        if(post.picture === ''){\n            post.picture = url;\n        }\n        let res = await API.createPost(post);\n        if(res.isSuccess){\n            navigate('/');\n        }\n    }\n\n    return (\n        <Container>\n            <Image src={url} alt=\"post\" />\n\n            <StyledFormControl>\n                <label htmlFor=\"fileInput\">\n                    <Add fontSize=\"large\" color=\"action\" />\n                </label>\n                <input\n                    type=\"file\"\n                    id=\"fileInput\"\n                    style={{ display: \"none\" }}\n                    onChange={(e) => setFile(e.target.files[0])}\n                />\n                <InputTextField onChange={(e) => handleChange(e)} name='title' placeholder=\"Title\" />\n                <Button onClick={() => savePost()} variant=\"contained\" color=\"primary\">Publish</Button>\n            </StyledFormControl>\n\n            <Textarea\n                rowsMin={5}\n                placeholder=\"Tell your story...\"\n                name='description'\n                onChange={(e) => handleChange(e)} \n            />\n        </Container>\n  )\n}\n\n\nconst Container = styled(Box)(({ theme }) => ({\n    margin: '50px 100px',\n    [theme.breakpoints.down('md')]: {\n        margin: 0\n    }\n}));\nconst Image = styled('img')({\n    width: '100%',\n    height: '50vh',\n    objectFit: 'cover'\n});\n\nconst StyledFormControl = styled(FormControl)`\n    margin-top: 10px;\n    display: flex;\n    flex-direction: row;\n`;\n\nconst InputTextField = styled(InputBase)`\n    flex: 1;\n    margin: 0 30px;\n    font-size: 25px;\n`;\nconst Textarea = styled(TextareaAutosize)`\n    width: 100%;\n    border: none;\n    margin-top: 50px;\n    font-size: 18px;\n    &:focus-visible {\n        outline: none;\n    }\n`;\n\nexport default CreatePost;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}